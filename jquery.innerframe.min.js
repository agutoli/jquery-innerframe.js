(function(a){a.fn.innerframe=function(b,c){var d=a(this),e={width:"100px",height:"100px",style:"",scrolling:"no",frameBorder:"0",name:"",onReady:function(){},seamless:"seamless",srcdoc:""},f=c?a.extend(e,c):e,g=document.createElement("iframe");g.id=("innerframe_"+(new Date).getTime()+Math.random()).replace(".","_");for(option in f)"function"!=typeof f[option]&&g.setAttribute(option,f[option]);window.setTimeout(function(){h._onReadyIframe()},1);var h={_contentWindow:function(){return g.contentWindow.document?g.contentWindow:document.frames[g.id]},_write:function(b){var c=h._contentWindow().document;window[g.id+"_im_ready"]=function(b){$doc=a("body",b.document),$doc.find("#innerframe_interval").remove(),h._onReadyInnerIframe($doc)},c.write('<html><head></head><body style="margin:0;padding:0;">'+b+"</body></html>"+'<script id="innerframe_interval">'+"window.__onloadIframe"+g.id+" = window.setInterval(function(){"+"if (typeof document.getElementsByTagName(\"body\")[0] != 'undefined'){"+"clearInterval(window.__onloadIframe"+g.id+");"+"window.parent."+g.id+"_im_ready(window);"+"if (typeof window.stop != 'undefined') {"+"window.stop();"+"}"+"}"+"}, 1);"+"</script>"),a(g).attr("style",f.style)},_onReadyIframe:function(){h._write(b)},_onReadyInnerIframe:function(b){b.find("[src]:not(script)").each(function(){var b=a(this).attr("src"),c=(new Date).getTime();b+=(b.match(/\?/gi)?"&":"?")+"innerframe_nocache="+c,a(this).attr("src",b)}),f.onReady(b)}};return this.each(function(){d.append(g)}),this}})(jQuery);
